listening-port=3478
tls-listening-port=443

listening-ip={{ turn_internal.stdout }}

relay-ip={{ turn_internal.stdout }}
external-ip={{ turn_external.stdout }}/{{ turn_internal.stdout }}
min-port=32769
max-port=65535
verbose

fingerprint
lt-cred-mech
use-auth-secret
static-auth-secret={{ turn_secret_key }}
realm={{ inventory_hostname }}

cert={{ lookup('vars', certificates + '_pem_path') }}
pkey={{ lookup('vars', certificates + '_key_path') }}
# From https://ssl-config.mozilla.org/ Intermediate, openssl 1.1.0g, 2020-01
cipher-list="ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384"
dh-file=/etc/turnserver/dhp.pem

keep-address-family
no-cli
no-tlsv1
no-tlsv1_1

# Block connections to IP ranges which shouldn't be reachable
no-loopback-peers
no-multicast-peers